AV.initialize("81s57z30iss714rpsvmgm3rsuxiha4imqz7adqtozc9iyzhr","4nrfo1hcwq6omwxa3maod5fmvwoc1gk3ogfh7ro9ookvdexh"),$(document).ready(function(){function e(){}function t(e){dictTemp={},console.log("try to generate navi");var t=b[e];if(void 0!=t){var i="";for(a(dictTemp),j=1;j<t.length;j++)brand=t[j],"all"!=brand&&(i+="<li><a href='#' class='navi_brand' id='"+brand+"'>"+dictTemp[brand]+"</a></li>");$(".nav_sub").html(i)}}function a(e){for(j=0;j<h.length;j++)brand=h[j],e[brand]=brand;e.all="所有品牌",e.other="其他",e.wallet="钱包",e.A_F="A&F",e.shoe="鞋子",e.baby_healthy="婴儿保健",e.baby_feeding="婴儿饮食",e.baby_daily="婴儿日用"}function o(e){e.Handbag=["钱包","all","Coach","MK","Rebecca_Minkoff","Kate_Spade","MMJ","wallet","other"],e.Bag=["包包","all","Coach","MK","Rebecca_Minkoff","Kate_Spade","MMJ","wallet","other"],e.Cloth=["衣服相关商品","all","Tommy","CK","A_F","Levis","Carters","US_POLO_ASSN","shoe","other"],e.Jewel=["首饰及附件","all","Swarovski","Juicy_Couture","other"],e.Nutrition=["保健品","all","GNC","MoveFree","Puritans_Pride","other"],e.Cosmetics=["化妆品","all","Lancome","Clinique","Esteem_Lauder","Kiehls","Origins","other"],e.Baby=["婴幼儿产品","all","baby_healthy","baby_feeding","baby_daily","other"],e.other=["其他商品","all","baby_healthy","baby_feeding","baby_daily","other"]}function l(e,t){for(i=0;i<e.length;i++){result=e[i];var a=result.get("product_name"),o=result.get("product_price"),l=result.get("product_desc"),r=result.get("product_type"),n=result.get("product_brand"),d=result.createdAt,s=d.toString();s=s.substring(4,15);for(var c=0,u=[],h="image_"+c,b=result.get(h);null!=b&&void 0!=b;)u.push(b.url()),c++,h="image_"+c,b=result.get(h);var g=u[0],f=result.id,p="<div class='col-sm-4 col-lg-4 col-md-4 "+r+" "+n+"'><div class='thumbnail'><img src='"+g+"'alt='' data-toggle='modal' data-target='#"+f+"'><hr><div class='caption'><h4><a href='#' data-toggle='modal' data-target='#"+f+"'>"+a+"</a></h4><button type='button' class='btn btn-default price' value="+o+" style='display:block'><span class='glyphicon glyphicon-piggy-bank' aria-hidden='true'></span>&nbsp&nbsp问价格</button><p style='line-height: 25px; width: auto;'>"+l+"</p><p style='line-height: 25px; width: auto; text-align:right;'>开卖日期:&nbsp"+s+"</p>",m="<div class='modal' id='"+f+"' role='dialog'><div class='modal-dialog'><div class='modal-content'><div class='modal-header'><h4 class='modal-title'>"+a+"</h4></div><div class='modal-body'>";for(j=0;j<u.length-1;j++)m+="<img src='"+u[j]+"' data-dismiss='modal'><hr>";m+="<img src='"+u[j]+"' data-dismiss='modal'></div><div class='modal-footer'></div></div></div></div>",$("#productS").append(p),$("#modalContainer").append(m)}t()}function r(){var e=$("#logo");"resources/piggy_round15.png"==e.attr("src")?e.attr("src","resources/piggy_round1.png"):e.attr("src","resources/piggy_round15.png")}var n=AV.Object.extend("Product"),d=new AV.Query(n),s=!1,c=!1,u=["Bag","Handbag","Cloth","Cosmetics","Nutrition","Jewel","Baby","Other"],h=["Coach","MMJ","MK","Rebecca_Minkoff","Kate_Spade","wallet","Tommy","CK","A_F","Levis","Carters","US_POLO_ASSN","shoe","Swarovski","Juicy_Couture","other","GNC","MoveFree","Puritans_Pride","Lancome","Clinique","Esteem_Lauder","Kiehls","Origins","baby_healthy","baby_feeding","baby_daily","other"],b={};o(b),d.limit(100),d.descending("createdAt"),d.find({success:function(e){l(e,function(){$(".start").click(function(){$("#productS").show(),$("#productS").scrollView(),setTimeout(function(){$("#logo").fadeIn(),$(".bubble").fadeIn(),c=!0},1e3),$(this).hide()}),$(".price").click(function(){if(s)$(".bubble").hide(),s=!1;else{var e=$(this).attr("value"),t="<p id='bubble'>"+e+"</p>";$(".bubble").html(t),$(".bubble").fadeIn(),s=!0,setTimeout(function(){$(".bubble").hide(),s=!1},3e3)}}),$("[data-toggle=modal]").on("click",function(){console.log("modal clicke");var e=$($(this).data("target"));return e.data("triggered",!0),setTimeout(function(){e.data("triggered")&&e.modal("show").data("triggered",!1)},250),!1})})},error:function(){console.log("failed to get object")}}),$(".sub").click(function(){var a=$(this).attr("id"),o=!0;for(i=0;i<u.length;i++){var l="."+u[i];u[i]==a?($(l).show(),0!=$(l).length&&(o=!1)):$(l).hide()}o&&e(),t(a)}),$(".navbar").on("click",".navi_brand",function(){console.log("brand clicked");var t=$(this).attr("id"),a=!0;for(i=0;i<h.length;i++){var o="."+h[i];h[i]==t?($(o).show(),0!=$(o).length&&(a=!1)):"all"!=t&&$(o).hide()}a&&e()}),$(".sub").click(function(){$(".navbar-collapse").collapse("hide"),$("#logo").attr("src","resources/piggy_round15.png")}),$("#logoB").click(function(){c&&($(".bubble").hide(),c=!1),r()}),$.fn.scrollView=function(){return this.each(function(){$("html, body").animate({scrollTop:$(this).offset().top},1e3)})}});